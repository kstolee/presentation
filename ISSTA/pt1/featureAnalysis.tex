% !TEX root = ../slides_ISSTA.tex
%\subsection{Feature Analysis}
%{
%%\setbeamertemplate{background canvas}{\tikz[remember picture]\node[opacity=0.5] at (current page.center) {\includegraphics[keepaspectratio]{../nontex/illustrations/galtonBoard.jpg}};}
%\begin{frame}
%\frametitle{What Features Are Used Most Frequently?}
%\begin{block}{\begin{Large}Regex Feature Usage References Are Missing\end{Large}}
%\begin{itemize}
%\item \begin{large}feature usage statistics\end{large}
%\item \begin{large}feature set summaries for variants and tools\end{large}
%\end{itemize}
%\end{block}
%\end{frame}
%}
%\note[itemize]{
%    \item the first usage study...
%    \item put yourself in the shoes of a tool designer...
%    \item there is no reference...
%    \item basic idea is to get a bunch of regexes, and count how often their features are used
%}

\subsection{Sampling}

\begin{frame}
\frametitle{Part 2}

\begin{block}{RQ3}
Which regular expression language features are most commonly used in Python?
\end{block}
\end{frame}

\begin{frame}
\frametitle{Project selection with the GitHub API}
\begin{columns}[t]
\column{.5\textwidth} % Left column and width
\begin{figure}[ht]
  \includegraphics[scale=0.16]{../nontex/illustrations/32Divided.pdf}
  \label{fig:32Divided}
\end{figure}
\column{.5\textwidth} % Right column and width
\begin{figure}[ht]
  \includegraphics[width=\linewidth]{../nontex/smallScrapersPNG/smallScrapers-112}
  % \animategraphics[loop,width=\linewidth]{10}{nontex/smallScrapersPNG/smallScrapers-}{0}{400}
    \label{fig:scraper}
\end{figure}
Out of 3,898 pseudo-randomly selected Python projects, 1,645 (42\%) contained one or more regex utilization.
\end{columns}
\end{frame}
\note[itemize]{
    \item in each section, average 1312 examined
    \item in each section, average 122 .py found
}

\begin{frame}
\frametitle{In Python: Utilizations of the re module}
\begin{figure}[h]
  \centering
  \includegraphics[scale=0.77]{../nontex/illustrations/exampleUsageLarge.pdf}
  \label{fig:exampleUsageLarge}
\end{figure}
\begin{description}
\item [function] which function of the re module is called?
\item [pattern] string used to specify regex behavior
\item [flags] modifies the regex engine
\end{description}
\end{frame}
\note[itemize]{
    \item 53,894 unique utilizations observed.
    \item pt 2
}


%------------------------------------------------




%------------------------------------------------

{
\setbeamertemplate{background canvas}{\tikz[remember picture,overlay]\node[opacity=0.3] at (current page.center) {\includegraphics[width=\paperwidth,height=\paperheight,keepaspectratio]{nontex/illustrations/funnel.png}};}
\begin{frame}
\frametitle{Filtering utilizations and patterns}
\begin{itemize}
\item [] \textbf{53,894} unique utilizations observed.
\item [] \begin{footnotesize}12.7\% use behavioral flags\end{footnotesize}
\item [] \begin{footnotesize}6.5\% were non-static patterns\end{footnotesize}
\item [] \textbf{43,525} utilizations remain
\item<2-> [] \textbf{13,711} distinct normalized patterns
\item<2-> [] \begin{footnotesize}114 had various errors\end{footnotesize}
%\item [] \begin{footnotesize}17 had non-Python features\end{footnotesize}
%\item [] \begin{footnotesize}22 had various errors\end{footnotesize}
%\item [] \begin{footnotesize}2 had ECOM feature - too rare to include\end{footnotesize}
\item<3-> [] \textbf{13,597} usable patterns from 1,645 projects remain for analysis
\end{itemize}

%\onslide<4->
%\begin{block}{}
%Average utilizations per project: 32
%\end{block}

\end{frame}
}
\note[itemize]{
    \item pt 2
}

%------------------------------------------------

%
%\begin{frame}
%\frametitle{Utilization statistics}
%\begin{itemize}
%     \item average utilizations per project was 32 and the maximum was 1,427
%     \item each project had an average of 11 files containing any utilization, but med was 6, so there is a skew bc of a few projects with so many
%     \item each of these files had an average of 2 utilizations (med 1)
%     \item avg 2 util. per file
%     \item max 207 util. per file
%     \item max 541 files w/utilizations, med was 2, Q3 was 6...this got skewed
%\end{itemize}
%\end{frame}



 \begin{frame}
 \frametitle{PCRE parsing patterns}
 \begin{figure}[h]
   \centering
   \includegraphics[scale=1.25]{nontex/illustrations/featureParsing.pdf}
   \label{fig:featureParsing}
 \end{figure}
 \begin{center}
 \begin{Large}
% \onslide<2->
% All Python features are recognizable by PCRE
 \end{Large}
 \end{center}
 \end{frame}
 \note[itemize]{
     \item pt 1
     \item pt 2
 }

% %------------------------------------------------

%\begin{frame}[fragile]
%\frametitle{Feature Statistics}
%\input{table/features/splitStatsOnly}
%\end{frame}
%\note[itemize]{
%    \item pt 1
%    \item pt 2
%}

%\begin{frame}
%\frametitle{Feature analysis}
%  \centering
%  PCRE parser
%  
%  \includegraphics[scale=1.25]{../nontex/illustrations/featureParsing.pdf}
%
%\end{frame}

%------------------------------------------------


\begin{frame}[fragile]
\frametitle{Feature statistics - Top 8}
\begin{center}
\input{table/features/topEight}
\end{center}
\end{frame}
\note[itemize]{
    \item present in more than 50\% of projects
    \item pt 2
}



\begin{frame}
\frametitle{Regex research tools}

\begin{itemize}
\item Remember that we wanted to write a tool to support regex creation?
\item<2-> But regex feature usage references were missing (not anymore!).
\item <3-> So, 
\end{itemize}

\onslide<4->{
\begin{block}{}%{\begin{Large}Regex Feature Usage References Are Missing\end{Large}}
\begin{large}How well do past and present regex research tools meet the needs of developers? (Hampi, Rex, RE2, brics)\end{large}
%\begin{itemize}
%\item \begin{large}feature usage statistics\end{large}
%\item \begin{large}feature set summaries for variants and tools\end{large}
%\end{itemize}
\end{block}
}

\end{frame}


%------------------------------------------------



%\begin{frame}[fragile]
%\frametitle{What Features Are Missing In Other Languages?}
%\input{table/features/splitLanguages}
%\end{frame}
%\note[itemize]{
%    \item Hampi supports the most features (25 features), followed by Rex (21 features), Automata.Z3 (14 features) and brics (12 features).
%}

%------------------------------------------------

%\begin{frame}[fragile]
%\frametitle{Ranked features: Languages - Notable Missing Features}
%\input{table/features/languagesMissingFeatures}
%\end{frame}
%\note[itemize]{
%    \item pt 1
%    \item pt 2
%}

%------------------------------------------------


\begin{frame}
\frametitle{Which features are  supported by analysis tools?}
\input{table/features/splitTools}
\end{frame}
\note[itemize]{
    \item Hampi supports the most features (25 features), followed by Rex (21 features), Automata.Z3 (14 features) and brics (12 features).
}

%------------------------------------------------


%\begin{frame}[fragile]
%\frametitle{Comparison Of Language Feature Sets}
%% \begin{footnotesize}Python has most commonly shared features, few rarely shared features.\end{footnotesize}
%\begin{columns}[t] % The "c" option specifies centered vertical alignment while the "t" option is used for top vertical alignment
%\column{.45\textwidth} % Left column and width
%\input{table/features/rankedFeatureSupport}
%\column{.45\textwidth} % Right column and width
%\input{table/features/unrankedFeatureSupport}
%\end{columns}
%
%
%\end{frame}
%\note[itemize]{
%    \item pt 1
%    \item pt 2
%}

%%------------------------------------------------
%
% \begin{frame}
% \frametitle{re module insights}
% \begin{figure}[ht]
%   \includegraphics[scale=0.6]{nontex/illustrations/partFunctions.pdf}
%   \label{fig:partFunctions}
% \end{figure}
% \begin{figure}[ht]
%   \includegraphics[scale=0.6]{nontex/illustrations/partFlags.pdf}
%   \label{fig:partFlags}
% \end{figure}
% \end{frame}
% \note[itemize]{
%     \item average utilizations per project was 32 and the maximum was 1,427
%     \item each project had an average of 11 files containing any utilization, but med was 6, so there is a skew bc of a few projects with so many
%     \item each of these files had an average of 2 utilizations (med 1)
%     \item avg 2 util. per file
%     \item max 207 util. per file
%     \item max 541 files w/utilizations, med was 2, Q3 was 6...this got skewed
%     \item
% }
%
%% %------------------------------------------------

\begin{frame}
\frametitle{Survey vs. Repository}

How often do you use.... 

\begin{center}
\begin{tabular}{llcr}
\toprule
\textbf{Group} & \textbf{Code} &  \textbf{Survey} & \textbf{Repo Rank} \\  \hline 
endpoint anchors & (STR, END) & 4.4 & 7, 8\\ \hline 
capture groups & (CG) & 4.2 & 2 \\ \hline 
word boundaries & (WNW) & 3.5 & 22 \\ \hline 
lazy repetition & (LZY) &  2.9 & 15 \\ \hline 
%(neg) look-ahead/behind &  (LKA, NLKA,  & 2.5 & 25, 21\\
%& LKB, NLKB) & & 28, 27\\
\bottomrule
\end{tabular}

\textcolor{red}{Key: 6 = very frequently, 5 = frequently, 4 = occasionally, \\3 = rarely, 2 = very rarely, 1 = never}
\end{center}

\end{frame}
%recall bias, bad sample of programs, or difference between ephemeral and persistent regexes

\begin{frame}
\frametitle{Notable Observations}

\begin{block}{}
\begin{itemize}
	\item Regexes are common, but not everywhere (42\% of projects, 32 utilizations per project)
	\item Current regex research tools cover the most common features
\end{itemize}
\end{block}

\onslide<2->
but....

\onslide<3->
\begin{block}{}
What are the regexes doing?
\end{block}


\end{frame}
